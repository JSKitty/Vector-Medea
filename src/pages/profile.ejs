<%- include('./partials/head',{title: `${request.body.serverHost} - Profile`}); %>
<link rel="stylesheet" href="/static/css/particles.css">
<link rel="stylesheet" href="/static/css/theme.css">
<style>
  .bg-profile {
    background-size: cover;
    background-image:url('<%= request.session.metadata.banner %>');
    height: 265px;
  }

  @media screen and (max-width: 400px){
    .bg-profile {
      height: 160px;
    }
  }

  @media screen and (min-width: 400px) and (max-width: 500px){
    .bg-profile {
      height: 175px;
    }
  }

  @media screen and (min-width: 500px) and (max-width: 576px){
    .bg-profile {
      height: 195px;
    }
  }


  @media screen and (min-width: 576px) and (max-width: 768px){
    .bg-profile {
      height: 210px;
    }
  }

  @media screen and (min-width: 768px) and (max-width: 992px){
    .bg-profile {
      height: 245px;
    }
  }

  @media screen and (min-width: 992px) and (max-width: 1200px){
    .bg-profile {
      height: 260px;
    }
  }

  .img-thumbnail {
    padding: 0;
    border-width: 2px;
  }
</style>
<html lang="en" class="h-100">
<body class="d-flex flex-column h-100 background-theme">
  <%- include('./partials/navbar', {active:'profile'}); %>
  <main class="container-sm py-0 px-0 py-sm-3">
    <div class="row d-flex justify-content-center align-items-center">
      <div class="col col-lg-10 col-xl-9 col-xxl-8">
        <div class="card border-0 z-1">
          <div class="rounded-top d-flex flex-row bg-profile">
            <div class="ms-4 pt-sm-2 pt-lg-1 mt-5 z-1 col-3 col-sm-3 col-md-3 col-lg-3">
              <div class="ratio ratio-1x1">
                <img src="<%= request.session.metadata.picture %>" 
                     alt="Profile image" class="img-thumbnail mt-5 mb-1 object-fit-cover aspect-ratio-content">
              </div>
            </div>
          </div>
          <div class="pt-2 pe-3 pb-2 z-1">
            <div class="d-flex justify-content-end text-center py-1">
              <div>
                <p class="mb-1 h5"><%= JSON.parse(JSON.stringify(request.session.metadata.mediaFiles || "0")).length %></p>
                <p class="small text-muted mb-0">Media</p>
              </div>
              <div class="px-3">
                <p class="mb-1 h5"><%= request.session.metadata.followers %></p>
                <p class="small text-muted mb-0">Followers</p>
              </div>
              <div>
                <p class="mb-1 h5"><%= request.session.metadata.following %></p>
                <p class="small text-muted mb-0">Following</p> 
              </div>
            </div>
            <div class=" ps-4 pe-4">
              <div class="d-flex flex-column align-middle mb-2">
                <span class="fw-semibold fs-5"><%= request.session.metadata.display_name %></span>
                <span class="fs-6"><%= request.session.metadata.nip05 %></span>
              </div>
              <p class="mb-0">
                <%- request.session.metadata.about %>
              </p>
            </div>
          </div>
          <div class="p-1 mb-2 z-1">
            <ul class="nav nav-pills ps-3" id="profileTabs" role="tablist">
              <li class="nav-item" >
                <button class="nav-link active" id="mediaFiles-tab" data-bs-toggle="tab" data-bs-target="#mediaFiles" type="button" role="tab" aria-controls="mediaFiles" aria-selected="true">Media files</button>
              </li>
              <li class="nav-item" >
                <button class="nav-link" id="userSettings-tab" data-bs-toggle="tab" data-bs-target="#userSettings" type="button" role="tab" aria-controls="userSettings" aria-selected="false">Settings</button>
            </ul>
            <div class="tab-content" id="profileTabsContent">
              <div class="tab-pane fade show active pt-3" id="mediaFiles" role="tabpanel" aria-labelledby="mediaFiles-tab">
                <%- include('./partials/gallery'); %>
              </div>
              <div class="tab-pane fade p-3" id="userSettings" role="tabpanel" aria-labelledby="userSettings-tab">
                <%- include('./partials/userSettings'); %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <div id="particles-js"></div> 
  <script src="/static/js/particles.min.js"></script>
  <script>
    particlesJS("particles-js", {"particles":{"number":{"value":80,"density":{"enable":true,"value_area":800}},"color":{"value":"#ffffff"},"shape":{"type":"circle","stroke":{"width":0,"color":"#000000"},"polygon":{"nb_sides":5},"image":{"src":"img/github.svg","width":100,"height":100}},"opacity":{"value":0.5,"random":false,"anim":{"enable":false,"speed":1,"opacity_min":0.1,"sync":false}},"size":{"value":3,"random":true,"anim":{"enable":false,"speed":40,"size_min":0.1,"sync":false}},"line_linked":{"enable":true,"distance":150,"color":"#ffffff","opacity":0.4,"width":1},"move":{"enable":true,"speed":6,"direction":"none","random":false,"straight":false,"out_mode":"out","bounce":false,"attract":{"enable":false,"rotateX":600,"rotateY":1200}}},"interactivity":{"detect_on":"canvas","events":{"onhover":{"enable":false,"mode":"grab"},"onclick":{"enable":true,"mode":"push"},"resize":true},"modes":{"grab":{"distance":400,"line_linked":{"opacity":1}},"bubble":{"distance":400,"size":40,"duration":2,"opacity":8,"speed":3},"repulse":{"distance":200,"duration":0.4},"push":{"particles_nb":4},"remove":{"particles_nb":2}}},"retina_detect":true});var count_particles, update; count_particles = document.querySelector('.js-count-particles'); 
  </script>
  <%- include('./partials/footer'); %>
</body>
</html>
